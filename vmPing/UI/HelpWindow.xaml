<Window x:Class="vmPing.UI.HelpWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Ayuda de vmPing"
        UseLayoutRounding="True"
        Height="575"
        Width="750"
        WindowStartupLocation="CenterScreen"
        PreviewKeyDown="Window_PreviewKeyDown"
        Loaded="Window_Loaded"
        Closed="Window_Closed">

    <Window.Resources>
        <Style TargetType="TextBlock">
            <Setter Property="TextWrapping" Value="Wrap" />
            <Setter Property="FontSize" Value="16" />
        </Style>
        <Style TargetType="Paragraph">
            <Setter Property="TextAlignment" Value="Left" />
            <Setter Property="FontFamily" Value="Segoe UI, Arial" />
            <Setter Property="FontSize" Value="16" />
        </Style>

        <!-- Title style -->
        <Style x:Key="TitleText"
               BasedOn="{StaticResource {x:Type TextBlock}}"
               TargetType="TextBlock">
            <Setter Property="Margin" Value="0,0,0,0" />
            <Setter Property="FontSize" Value="26" />
            <Setter Property="FontFamily" Value="Segoe UI" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="HorizontalAlignment" Value="Center" />
        </Style>

        <!-- HyperLink style -->
        <Style x:Key="HyperlinkStyle"
               BasedOn="{StaticResource {x:Type Hyperlink}}"
               TargetType="Hyperlink">
            <Setter Property="TextDecorations" Value="None" />
            <Setter Property="FontSize" Value="16" />
            <Setter Property="Foreground" Value="#6c71c4" />
        </Style>

        <!-- Version style -->
        <Style x:Key="VersionText"
               BasedOn="{StaticResource {x:Type Paragraph}}"
               TargetType="Paragraph">
            <Setter Property="FontSize" Value="16" />
            <Setter Property="Foreground" Value="#707070" />
            <Setter Property="Margin" Value="0,0,0,0" />
            <Setter Property="TextAlignment" Value="Center" />
        </Style>

        <!-- Section header style -->
        <Style x:Key="HeaderText"
               BasedOn="{StaticResource {x:Type Paragraph}}"
               TargetType="Paragraph">
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Margin" Value="0,40,0,0" />
            <Setter Property="Foreground" Value="#4040c0" />
            <Setter Property="FontSize" Value="26" />
        </Style>

        <!-- Sub-header style -->
        <Style x:Key="SubHeaderText"
               BasedOn="{StaticResource {x:Type Paragraph}}"
               TargetType="Paragraph">
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Margin" Value="0,25,0,0" />
            <Setter Property="Foreground" Value="#404040" />
            <Setter Property="FontSize" Value="16" />
        </Style>

        <!-- Paragraph style -->
        <Style x:Key="ParagraphText"
               BasedOn="{StaticResource {x:Type Paragraph}}"
               TargetType="Paragraph">
            <Setter Property="Margin" Value="0,2,0,0" />
            <Setter Property="Foreground" Value="#606060" />
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <TreeView Name="tree" FontSize="11pt" BorderThickness="0" Padding="12,24" Margin="0" Background="#F3F4F6">
            <TreeView.ItemContainerStyle>
                <Style TargetType="TreeViewItem">
                    <Setter Property="Margin" Value="0,2"/>
                    <Setter Property="Padding" Value="8,4"/>
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="Foreground" Value="#2563EB"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </TreeView.ItemContainerStyle>
            <TreeViewItem Header="Introducción" Selected="Intro_Selected" IsSelected="True" />
            <TreeViewItem Header="Uso Básico" Selected="BasicUsage_Selected" />
            <TreeViewItem Header="Funciones Extra" Selected="ExtraFeatures_Selected" />
            <TreeViewItem Header="Opciones" Selected="Options_Selected" />
            <TreeViewItem Header="Uso de Línea de Comandos" Selected="CommandLineUsage_Selected" />
            <TreeViewItem Header="Manual de Usuario" Selected="UserManual_Selected" />
            <TreeViewItem Header="Manual Técnico" Selected="TechnicalManual_Selected" />
        </TreeView>
        <GridSplitter Grid.Column="1" Width="4"
                      HorizontalAlignment="Center"
                      BorderBrush="Black"
                      BorderThickness="0"
                      VerticalAlignment="Stretch" />

        <FlowDocumentScrollViewer Name="MainDocument" Grid.Column="2" FocusVisualStyle="{x:Null}">
            <FlowDocument>
                <!-- Logo and title -->
                <BlockUIContainer>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,20">
                        <Image Source="/vmPing.ico" Width="32" Height="32" Margin="0,0,12,0" />
                        <TextBlock Style="{StaticResource TitleText}"
                                   VerticalAlignment="Center"
                                   Text="vmPing">
                            <TextBlock.Effect>
                                <DropShadowEffect ShadowDepth="4" Direction="330" Color="Black" Opacity="0.15" BlurRadius="4" />
                            </TextBlock.Effect>
                        </TextBlock>
                    </StackPanel>
                </BlockUIContainer>

                <!-- Link to homepage -->
                <Paragraph TextAlignment="Center">
                    <Hyperlink NavigateUri="https://github.com/R-Smith/vmPing"
                               RequestNavigate="Hyperlink_RequestNavigate"
                               Style="{StaticResource HyperlinkStyle}">
                        https://github.com/R-Smith/vmPing
                    </Hyperlink>
                </Paragraph>

                <!-- Version -->
                <Paragraph Name="Version"
                           Style="{StaticResource  VersionText}"
                           Margin="0,3,0,0">
                    Version X.XXXX.XXXX
                </Paragraph>
                <Paragraph Name="Copyright"
                           Style="{StaticResource VersionText}">
                    Copyright (C) Ryan Smith
                </Paragraph>
                <Paragraph Style="{StaticResource VersionText}" Margin="0,10,0,0">
                    <Run Foreground="#3B82F6" FontWeight="Bold">Pro Edition</Run>
                    <LineBreak/>
                    <Run Foreground="#6B7280" FontSize="12">Redesigned &amp; Optimized by</Run>
                </Paragraph>
                <Paragraph Style="{StaticResource VersionText}" Foreground="#111827" FontWeight="ExtraBold" FontSize="18">
                    &lt; Gabriel /&gt;
                </Paragraph>

                <!-- Intro section -->
                <BlockUIContainer>
                    <Rectangle Margin="0,30,0,0" HorizontalAlignment="Stretch" Fill="#f0f0f0" Height="1" />
                </BlockUIContainer>
                <Paragraph Name="Intro" Margin="0,5"
                           Foreground="#073642">
                    vmPing es una utilidad de red que le permite monitorear rápidamente la disponibilidad de múltiples hosts.
                    Los monitores de host son fáciles de agregar y eliminar, y se redimensionan dinámicamente con la ventana de la aplicación.
                    La codificación por colores le permite ver de un vistazo el estado de cada host.
                </Paragraph>
                <BlockUIContainer>
                    <Rectangle HorizontalAlignment="Stretch" Fill="#f0f0f0" Height="1" />
                </BlockUIContainer>

                <!-- Basic Usage section -->
                <Paragraph Name="BasicUsage"
                           Style="{StaticResource HeaderText}">
                    Uso Básico
                </Paragraph>
                <Paragraph Style="{StaticResource SubHeaderText}">
                    Resumen de la aplicación
                </Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">

                </Paragraph>
                <Paragraph Style="{StaticResource SubHeaderText}">
                    Monitorear un host
                </Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    Ingrese un nombre de host o dirección IP en el cuadro de texto, luego presione Enter o haga clic en Ping.
                    vmPing hará ping continuamente al host hasta que haga clic en Detener.
                    Las respuestas se muestran en el área de salida sobre el cuadro de texto.
                    La sección de salida se volverá verde cuando el host responda y roja cuando no responda.
                    Si ocurre un error, el área de salida se volverá naranja.
                </Paragraph>
                <Paragraph Style="{StaticResource SubHeaderText}">
                    Agregar un monitor de host
                </Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    <Run>Haga clic en</Run>
                    <Image Source="{StaticResource icon.add}" Width="14" Height="14" Margin="3,0,0,0"/>
                    <Run FontWeight="SemiBold">Agregar Host</Run>
                    <Run>desde la barra de menú, o use el atajo de teclado,</Run>
                    <Run FontWeight="SemiBold">Alt-A</Run> .
                </Paragraph>
                <Paragraph Style="{StaticResource SubHeaderText}">
                    Eliminar un monitor de host
                </Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    Cuando pasa el mouse sobre un monitor de host, aparecerá un icono X en la esquina superior derecha.
                    Haga clic en el icono X para eliminar esa instancia.
                </Paragraph>
                <Paragraph Style="{StaticResource SubHeaderText}">
                    Columnas
                </Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    Haga clic en Columnas en la barra de menú y luego mueva el control deslizante al número deseado de columnas.
                    Esto establece el número de monitores de host para mostrar en una sola fila.
                    Se crearán filas adicionales según sea necesario.
                </Paragraph>

                <!-- Extra Features section -->
                <Paragraph Name="ExtraFeatures"
                           Style="{StaticResource HeaderText}">
                    Funciones Extra
                </Paragraph>
                <Paragraph Style="{StaticResource SubHeaderText}">
                    Monitor de Puerto
                </Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    Para monitorear un puerto TCP específico, simplemente ingrese el nombre de host o la dirección IP seguido de dos puntos y el número de puerto deseado.
                    vmPing intentará conectarse continuamente al puerto dado y mostrará si la conexión es exitosa o no.
                    Ejemplo -
                    <Bold>SERVER01:80</Bold> , monitoreará el puerto 80 en SERVER01.
                </Paragraph>
                <Paragraph Style="{StaticResource SubHeaderText}">
                    Trazar Ruta (Trace Route)
                </Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    La utilidad de trazar ruta se utiliza para medir los retrasos de red y determinar la ruta tomada hacia el host de destino.
                    Se puede acceder a la utilidad desde el icono desplegable en la esquina superior derecha o presionando Ctrl-T.
                </Paragraph>
                <Paragraph Style="{StaticResource SubHeaderText}">
                    Inundar Host (Flood Host)
                </Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    La utilidad de inundación de host se utiliza para generar una cantidad significativa de paquetes ICMP.
                    Para limitar el flujo, la utilidad espera hasta recibir una respuesta antes de enviar el siguiente paquete ICMP.
                    Se puede acceder a la utilidad desde el icono desplegable en la esquina superior derecha o presionando Ctrl-F.
                </Paragraph>

                <!-- Options section -->
                <Paragraph Name="Options"
                           Style="{StaticResource HeaderText}">
                    Opciones
                </Paragraph>
                <Paragraph Style="{StaticResource SubHeaderText}">
                    Intervalo de Ping
                </Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    El tiempo de espera entre el envío de cada paquete. El tiempo se puede especificar en segundos, minutos u horas.
                </Paragraph>
                <Paragraph Style="{StaticResource SubHeaderText}">
                    Tiempo de espera de Ping
                </Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    El tiempo máximo de espera para una respuesta, en segundos.
                </Paragraph>
                <Paragraph Style="{StaticResource SubHeaderText}">
                    Enviar correo cuando el host cambia de estado
                </Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    Envía un correo electrónico cada vez que un host cambia de estado (de inactivo a activo o viceversa).
                    Se deben especificar un servidor de correo, una dirección de correo electrónico del destinatario y una dirección de correo electrónico del remitente.
                </Paragraph>
                <Paragraph Style="{StaticResource SubHeaderText}">
                    Mantener ventana siempre visible
                </Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    La ventana de vmPing permanecerá encima de todas las demás ventanas de aplicaciones.
                </Paragraph>
                <Paragraph Style="{StaticResource SubHeaderText}">
                    Registrar toda la salida en archivos
                </Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    Escribe todas las respuestas de ping en un archivo de texto.
                    El archivo se llamará &lt;hostname&gt;.txt y se guardará en el directorio especificado.
                    Si el archivo ya existe, la nueva salida se agregará al archivo existente.
                </Paragraph>

                <!-- Command Line Usage section -->
                <Paragraph Name="CommandLineUsage"
                           Style="{StaticResource HeaderText}">
                    Uso de Línea de Comandos
                </Paragraph>
                <Paragraph Style="{StaticResource SubHeaderText}">
                    Uso: vmPing [-i intervalo] [-w tiempo_espera] [&lt;host_destino>...]
                </Paragraph>

                <!-- TODO: Convert to table-->
                <!--<DockPanel>
                    <TextBlock Style="{StaticResource ParagraphText}"
                                   FontFamily="Consolas Courier New"
                                   FontSize="14"
                                   Width="90">
                            -i interval
                    </TextBlock>
                    <TextBlock Style="{StaticResource ParagraphText}"
                                   TextWrapping="Wrap">
                            Time, in seconds, to wait between sending each ping.
                    </TextBlock>
                </DockPanel>
                <DockPanel>
                    <TextBlock Style="{StaticResource ParagraphText}"
                                   FontFamily="Consolas Courier New"
                                   FontSize="14"
                                   Width="90">
                            -w timeout
                    </TextBlock>
                    <TextBlock Style="{StaticResource ParagraphText}"
                                   TextWrapping="Wrap">
                            Timeout, in seconds, to wait for each reply.
                    </TextBlock>
                </DockPanel>
                <DockPanel>
                    <TextBlock Style="{StaticResource ParagraphText}"
                                   FontFamily="Consolas Courier New"
                                   FontSize="14"
                                   Width="90">
                            target_host
                    </TextBlock>
                    <TextBlock Style="{StaticResource ParagraphText}">
                            Ping the specified host.  Multiple hostnames may be specified.
                    </TextBlock>
                </DockPanel>-->
                <!-- Check docs/Manual_Usuario.md and docs/Manual_Tecnico.md for full text -->

                <!-- USER MANUAL (ES) -->
                <Paragraph Name="UserManual" Style="{StaticResource HeaderText}">
                    Manual de Usuario (ES)
                </Paragraph>
                
                <Paragraph Style="{StaticResource SubHeaderText}">1. Introducción</Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    vmPing (Visual Multi Ping) es una utilidad gráfica de ping para monitorear múltiples hosts. Se pueden agregar y eliminar numerosos monitores de host, y cada monitor cambia de tamaño dinámicamente con la ventana de la aplicación.
                </Paragraph>

                <Paragraph Style="{StaticResource SubHeaderText}">2. Puesta en Marcha</Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    vmPing es portátil. Simplemente ejecute vmPing.exe.
                </Paragraph>

                <Paragraph Style="{StaticResource SubHeaderText}">3. Uso Básico</Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    <Bold>Agregar Hosts:</Bold> Escriba una IP o hostname y presione Enter.
                    <LineBreak/>
                    <Bold>Colores:</Bold> Verde (UP), Rojo (DOWN), Naranja (Error/Indeterminado).
                </Paragraph>

                <Paragraph Style="{StaticResource SubHeaderText}">4. Personalización (Nuevos Temas)</Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    Vaya al menú Opciones -> Interface para cambiar temas:
                    <LineBreak/>
                    - <Bold>Professional Light / Dark</Bold>
                    <LineBreak/>
                    - <Bold>Ocean Blue</Bold>, <Bold>Sunset Orange</Bold>, <Bold>Crimson Red</Bold>
                    <LineBreak/>
                    - <Bold>Hacking (Matrix)</Bold>
                </Paragraph>

                 <!-- TECHNICAL MANUAL (ES) -->
                <Paragraph Name="TechnicalManual" Style="{StaticResource HeaderText}">
                    Manual Técnico (ES)
                </Paragraph>

                <Paragraph Style="{StaticResource SubHeaderText}">1. Arquitectura</Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    Aplicación WPF .NET Framework usando MVVM.
                    <LineBreak/>
                    Componentes clave:
                    <LineBreak/>
                    - <Bold>Probe.cs</Bold>: Lógica principal de monitoreo.
                    <LineBreak/>
                    - <Bold>Themes.xaml</Bold>: Diccionarios de recursos para temas.
                    <LineBreak/>
                    - <Bold>PopupNotificationWindow.xaml</Bold>: Sistema de alertas flotantes.
                </Paragraph>

                <Paragraph Style="{StaticResource SubHeaderText}">2. Ubicación de Archivos</Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    Los manuales completos se encuentran en la carpeta <Bold>docs/</Bold> de la aplicación:
                    <LineBreak/>
                    - <Hyperlink NavigateUri="file:///c:/xampp/htdocs/vmPing-main/docs/Manual_Usuario.md">Manual_Usuario.md</Hyperlink>
                    <LineBreak/>
                    - <Hyperlink NavigateUri="file:///c:/xampp/htdocs/vmPing-main/docs/Manual_Tecnico.md">Manual_Tecnico.md</Hyperlink>
                </Paragraph>
                <Paragraph Style="{StaticResource ParagraphText}">
                    (Nota: Los enlaces a archivos locales pueden no abrirse directamente por seguridad, por favor navegue a la carpeta docs).
                </Paragraph>

            </FlowDocument>
        </FlowDocumentScrollViewer>
    </Grid>
</Window>
